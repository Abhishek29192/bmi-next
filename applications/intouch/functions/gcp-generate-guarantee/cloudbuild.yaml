### Template for public HTTP functions ###

steps:
  - name: "gcr.io/cloud-builders/gcloud"
    args:
      - functions
      - deploy
      - pubsub-generate-guarantee
      - --source=gs://${_GCP_INTOUCH_REPLATFORM_BUILD_STORAGE}/gcp-generate-guarantee.zip
      - --runtime=nodejs14
      - --entry-point=sendGuaranteePdf
      - --region=europe-west2
      - --trigger-topic=guarantee-pdf
      - --set-env-vars=GCP_SECRET_PROJECT=${_GCP_SECRET_PROJECT},GCP_PRIVATE_BUCKET_NAME={_GCP_PRIVATE_BUCKET_NAME},MAIL_FROM=${_INTOUCH_MAIL_FROM},NPM_AUTH_READ_TOKEN=${_NPM_AUTH_READ_TOKEN},GATEWAY_API_URL=${_INTOUCH_GATEWAY_API_URL}
