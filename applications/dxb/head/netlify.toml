# Settings in the [build] context are global and are applied to all contexts
# unless otherwise overridden by more specific contexts.
[build]
# Directory that contains the deploy-ready HTML files and assets generated by
# the build. This is relative to the base directory if one has been set, or
# the root directory if a base has not been set. This sample publishes the
# directory located at the absolute path "root/project/build-output"
publish = "public/"

# Default build command.
command = "node ./scripts/netlify-toml-builder.js && node ./scripts/netlify-token-replacer.js && yarn build-contentful && yarn workspace @bmi/head run build --log-pages"

# Global environment variables.
# For node version, should match .nvmrc
environment = { GATSBY_EXPERIMENTAL_PAGE_BUILD_ON_DATA_CHANGES = "true", YARN_FLAGS = "--frozen-lockfile", NETLIFY_YARN_WORKSPACES = "true", NETLIFY_USE_YARN = "true", NODE_VERSION = "lts/erbium" }

[[plugins]]
# enable Gatsby.js incremental builds plugin.
package = "netlify-plugin-gatsby-cache"

[[plugins]]
package = "../libraries/netlify-plugin-trigger-gitlab"

  [plugins.inputs]
  gitlabUrl = "https://gitlab.com/api/v4/projects/19163612/trigger/pipeline"
  application = "head"

[[headers]]
# Define which paths this specific [[headers]] block will cover.
for = "/*"

  [headers.values]
  X-Frame-Options = "DENY"
  X-Robots-Tag = "X_ROBOTS_TAG"
  X-XSS-Protection = "1; mode=block"
  X-Content-Type-Options = "nosniff"
  Referrer-Policy = "strict-origin-when-cross-origin"
  Content-Security-Policy = "CONTENT_SECURITY_POLICY"
  Access-Control-Allow-Origin = "ACCESS_CONTROL_ALLOW_ORIGIN"


  # Placeholder for redirects - everything below this line gets replaced
  # Please ensure any other settings you wish to keep are above this line
  # *** REDIRECTS_START_HERE ***
