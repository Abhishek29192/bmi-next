import { renderToString } from "react-dom/server";
import React from "react";
import { BMI as BmiIcon } from "@bmi-digital/components/logo";
import {
  createSchemaOrgForBrandPage,
  createSchemaOrgForHomeAndBrandPage,
  createSchemaOrgForHomePage
} from "../schemaOrgHomeAndBrandPage";

describe("createSchemaOrgForHomeAndBrandPage", () => {
  it("should return schema for home page", () => {
    const siteUrl = "http://bmigroup.com";
    const countryCode = "US";
    const description = "Homepage description";
    const brandLogo = "brand-logo-url";
    const title = "Homepage title";
    const path = "/";
    const sameAs = "https://example.com";

    const expectedSchema = {
      "@type": "organization",
      description,
      inLanguage: countryCode,
      url: `${siteUrl}/${countryCode}/`,
      sameAs: sameAs,
      name: `BMI Group ${countryCode}`,
      logo: renderToString(<BmiIcon />)
    };

    const schema = createSchemaOrgForHomeAndBrandPage(
      siteUrl,
      "homePage",
      countryCode,
      path,
      description,
      brandLogo,
      title,
      sameAs
    );

    expect(schema).toEqual(expectedSchema);
  });

  it("should return schema for brand page", () => {
    const siteUrl = "http://bmigroup.com";
    const countryCode = "US";
    const description = "Brand page description";
    const brandLogo = "AeroDek";
    const expectedBrandLogo =
      '<svg viewBox="0 0 244 100" xmlns="http://www.w3.org/2000/svg" xml:space="preserve"><path d="M15.506 29H25.89l15.236 41.02H30.882l-3.187-9.387H13.02L9.833 70.02H0L15.506 29Zm9.833 24.444-4.981-15.466-5.263 15.466H25.34ZM72.008 66.851c-.28.14-.832.55-1.523.97-.832.55-1.664.97-2.636 1.38-1.243.55-2.496.97-3.74 1.24-1.663.409-3.327.549-4.98.549-2.356 0-4.572-.41-6.787-1.11-1.934-.69-3.598-1.8-5.122-3.179-1.383-1.38-2.495-3.04-3.187-4.839-.692-2.07-1.113-4.139-1.113-6.358 0-1.93.28-4.01.972-5.799 1.243-3.729 4.15-6.628 7.759-8.288a16.83 16.83 0 0 1 6.374-1.24c2.226 0 4.29.41 6.235 1.24 1.804.83 3.328 1.93 4.57 3.45a14.765 14.765 0 0 1 2.767 5.248c.692 2.21.973 4.419.973 6.628v1.52H51.66c0 1.66.833 3.04 2.076 4.139 1.523 1.24 3.598 1.93 5.543 1.8 1.934.14 3.878-.28 5.673-.97 1.112-.55 2.215-1.11 3.187-1.8l3.88 5.389-.01.03ZM64.12 52.624c0-.69-.14-1.24-.411-1.93-.27-.689-.692-1.239-1.113-1.799a6.98 6.98 0 0 0-1.934-1.38c-.822-.41-1.804-.55-2.636-.55-.973 0-1.935.14-2.767.55-.691.28-1.383.83-1.934 1.38-.552.55-.973 1.11-1.243 1.8-.281.55-.411 1.24-.411 1.93H64.13h-.01ZM77.692 41.157h8.59l.28 3.59c.832-1.11 1.935-2.07 3.047-2.76 1.524-.97 3.328-1.38 5.122-1.38.692 0 1.384 0 2.075.14l1.664.41-1.383 7.868a13.282 13.282 0 0 0-3.188-.41c-1.934-.14-3.738.55-5.122 1.93-1.383 1.38-2.075 3.32-1.934 5.389V70.02h-9.001l-.14-28.863h-.01ZM99.703 55.524c0-2.07.411-4.14 1.113-5.939.701-1.8 1.804-3.45 3.187-4.839 1.383-1.39 3.047-2.49 4.982-3.319a16.823 16.823 0 0 1 6.374-1.24c2.226 0 4.291.41 6.375 1.24 1.805.69 3.458 1.93 4.982 3.32 1.383 1.379 2.496 3.038 3.187 4.838a16.364 16.364 0 0 1 0 12.017c-.691 1.8-1.804 3.45-3.187 4.84-1.383 1.389-3.047 2.489-4.982 3.318a16.825 16.825 0 0 1-6.375 1.24c-2.225 0-4.43-.41-6.374-1.24a14.767 14.767 0 0 1-8.169-8.148c-.692-1.93-1.113-4.009-1.113-6.078v-.01Zm15.787 7.738c.972 0 2.075-.14 3.047-.69.832-.41 1.664-.97 2.215-1.8.551-.69 1.113-1.52 1.383-2.489.552-1.8.552-3.87 0-5.659-.28-.97-.691-1.8-1.383-2.489-.551-.69-1.383-1.24-2.215-1.66-.972-.41-1.935-.69-3.047-.69-1.113 0-2.075.14-3.047.69-.832.41-1.664.97-2.216 1.66-.551.69-1.112 1.52-1.383 2.49a7.982 7.982 0 0 0 0 5.658c.281.97.692 1.8 1.383 2.49a7.107 7.107 0 0 0 2.216 1.799c.972.55 1.934.83 3.047.69ZM137.231 29h15.786c3.048 0 5.954.41 8.861 1.24 2.626.69 4.982 2.07 7.067 3.729a16.476 16.476 0 0 1 4.57 6.488c1.113 2.9 1.805 6.079 1.664 9.258.141 3.04-.551 6.079-1.664 8.838-1.112 2.49-2.626 4.559-4.711 6.358-2.085 1.8-4.43 3.04-7.066 3.87a32.622 32.622 0 0 1-8.861 1.24h-15.646V29Zm15.235 32.732c4.15 0 7.337-1.11 9.693-3.179 2.355-2.35 3.598-5.529 3.328-8.838 0-1.8-.281-3.45-.832-5.109-.411-1.52-1.243-2.76-2.356-3.869-1.112-1.11-2.496-1.93-4.019-2.49-1.935-.689-3.879-.969-5.814-.829h-5.813v24.314h5.813ZM208.687 66.851c-.28.14-.831.55-1.523.97-.832.55-1.664.97-2.626 1.38-1.243.55-2.496.97-3.739 1.24-1.664.409-3.328.549-4.982.549-2.355 0-4.57-.41-6.785-1.11-1.935-.69-3.599-1.8-5.122-3.179-1.384-1.38-2.496-3.04-3.188-4.839-.691-2.07-1.112-4.139-1.112-6.358 0-1.93.28-4.01.972-5.799 1.243-3.729 4.15-6.628 7.758-8.288 2.075-.83 4.15-1.24 6.375-1.24 2.225 0 4.29.41 6.234 1.24 1.805.83 3.328 1.93 4.571 3.45a14.775 14.775 0 0 1 2.767 5.248c.691 2.21.972 4.419.972 6.628v1.52H188.35c0 1.66.832 3.04 2.075 4.139 1.523 1.24 3.598 1.93 5.543 1.8 1.934.14 3.879-.28 5.673-.97 1.113-.55 2.215-1.11 3.187-1.8l3.88 5.389-.021.03Zm-7.888-14.227c0-.69-.14-1.24-.411-1.93-.271-.689-.692-1.239-1.112-1.799a6.991 6.991 0 0 0-1.935-1.38c-.822-.41-1.804-.55-2.626-.55-.972 0-1.935.14-2.767.55-.691.28-1.383.69-1.934 1.38-.551.55-.972 1.11-1.243 1.8-.281.55-.411 1.24-.411 1.93h12.459-.02ZM214.371 29h9.001v21.275l9.001-9.118h10.244l-10.525 10.638L244 70.03h-10.384l-7.478-12.157-2.626 2.63v9.527h-9.001l-.14-41.02V29Z" fill="#70706F"></path></svg>';
    const title = "Brand page title";
    const path = "/brand";
    const sameAs = "https://example.com,https://example2.com";

    const expectedSchema = {
      "@type": "organization",
      description,
      inLanguage: countryCode,
      url: `${siteUrl}/${countryCode}/brand/`,
      sameAs: ["https://example.com", "https://example2.com"],
      name: title,
      logo: expectedBrandLogo
    };

    const schema = createSchemaOrgForHomeAndBrandPage(
      siteUrl,
      "brandPage",
      countryCode,
      path,
      description,
      brandLogo,
      title,
      sameAs
    );

    expect(schema).toEqual(expectedSchema);
  });

  it("should remove spaces from sameAsString and return schema for brand page", () => {
    const siteUrl = "http://bmigroup.com";
    const countryCode = "US";
    const description = "Brand page description";
    const brandLogo = "AeroDek";
    const expectedBrandLogo =
      '<svg viewBox="0 0 244 100" xmlns="http://www.w3.org/2000/svg" xml:space="preserve"><path d="M15.506 29H25.89l15.236 41.02H30.882l-3.187-9.387H13.02L9.833 70.02H0L15.506 29Zm9.833 24.444-4.981-15.466-5.263 15.466H25.34ZM72.008 66.851c-.28.14-.832.55-1.523.97-.832.55-1.664.97-2.636 1.38-1.243.55-2.496.97-3.74 1.24-1.663.409-3.327.549-4.98.549-2.356 0-4.572-.41-6.787-1.11-1.934-.69-3.598-1.8-5.122-3.179-1.383-1.38-2.495-3.04-3.187-4.839-.692-2.07-1.113-4.139-1.113-6.358 0-1.93.28-4.01.972-5.799 1.243-3.729 4.15-6.628 7.759-8.288a16.83 16.83 0 0 1 6.374-1.24c2.226 0 4.29.41 6.235 1.24 1.804.83 3.328 1.93 4.57 3.45a14.765 14.765 0 0 1 2.767 5.248c.692 2.21.973 4.419.973 6.628v1.52H51.66c0 1.66.833 3.04 2.076 4.139 1.523 1.24 3.598 1.93 5.543 1.8 1.934.14 3.878-.28 5.673-.97 1.112-.55 2.215-1.11 3.187-1.8l3.88 5.389-.01.03ZM64.12 52.624c0-.69-.14-1.24-.411-1.93-.27-.689-.692-1.239-1.113-1.799a6.98 6.98 0 0 0-1.934-1.38c-.822-.41-1.804-.55-2.636-.55-.973 0-1.935.14-2.767.55-.691.28-1.383.83-1.934 1.38-.552.55-.973 1.11-1.243 1.8-.281.55-.411 1.24-.411 1.93H64.13h-.01ZM77.692 41.157h8.59l.28 3.59c.832-1.11 1.935-2.07 3.047-2.76 1.524-.97 3.328-1.38 5.122-1.38.692 0 1.384 0 2.075.14l1.664.41-1.383 7.868a13.282 13.282 0 0 0-3.188-.41c-1.934-.14-3.738.55-5.122 1.93-1.383 1.38-2.075 3.32-1.934 5.389V70.02h-9.001l-.14-28.863h-.01ZM99.703 55.524c0-2.07.411-4.14 1.113-5.939.701-1.8 1.804-3.45 3.187-4.839 1.383-1.39 3.047-2.49 4.982-3.319a16.823 16.823 0 0 1 6.374-1.24c2.226 0 4.291.41 6.375 1.24 1.805.69 3.458 1.93 4.982 3.32 1.383 1.379 2.496 3.038 3.187 4.838a16.364 16.364 0 0 1 0 12.017c-.691 1.8-1.804 3.45-3.187 4.84-1.383 1.389-3.047 2.489-4.982 3.318a16.825 16.825 0 0 1-6.375 1.24c-2.225 0-4.43-.41-6.374-1.24a14.767 14.767 0 0 1-8.169-8.148c-.692-1.93-1.113-4.009-1.113-6.078v-.01Zm15.787 7.738c.972 0 2.075-.14 3.047-.69.832-.41 1.664-.97 2.215-1.8.551-.69 1.113-1.52 1.383-2.489.552-1.8.552-3.87 0-5.659-.28-.97-.691-1.8-1.383-2.489-.551-.69-1.383-1.24-2.215-1.66-.972-.41-1.935-.69-3.047-.69-1.113 0-2.075.14-3.047.69-.832.41-1.664.97-2.216 1.66-.551.69-1.112 1.52-1.383 2.49a7.982 7.982 0 0 0 0 5.658c.281.97.692 1.8 1.383 2.49a7.107 7.107 0 0 0 2.216 1.799c.972.55 1.934.83 3.047.69ZM137.231 29h15.786c3.048 0 5.954.41 8.861 1.24 2.626.69 4.982 2.07 7.067 3.729a16.476 16.476 0 0 1 4.57 6.488c1.113 2.9 1.805 6.079 1.664 9.258.141 3.04-.551 6.079-1.664 8.838-1.112 2.49-2.626 4.559-4.711 6.358-2.085 1.8-4.43 3.04-7.066 3.87a32.622 32.622 0 0 1-8.861 1.24h-15.646V29Zm15.235 32.732c4.15 0 7.337-1.11 9.693-3.179 2.355-2.35 3.598-5.529 3.328-8.838 0-1.8-.281-3.45-.832-5.109-.411-1.52-1.243-2.76-2.356-3.869-1.112-1.11-2.496-1.93-4.019-2.49-1.935-.689-3.879-.969-5.814-.829h-5.813v24.314h5.813ZM208.687 66.851c-.28.14-.831.55-1.523.97-.832.55-1.664.97-2.626 1.38-1.243.55-2.496.97-3.739 1.24-1.664.409-3.328.549-4.982.549-2.355 0-4.57-.41-6.785-1.11-1.935-.69-3.599-1.8-5.122-3.179-1.384-1.38-2.496-3.04-3.188-4.839-.691-2.07-1.112-4.139-1.112-6.358 0-1.93.28-4.01.972-5.799 1.243-3.729 4.15-6.628 7.758-8.288 2.075-.83 4.15-1.24 6.375-1.24 2.225 0 4.29.41 6.234 1.24 1.805.83 3.328 1.93 4.571 3.45a14.775 14.775 0 0 1 2.767 5.248c.691 2.21.972 4.419.972 6.628v1.52H188.35c0 1.66.832 3.04 2.075 4.139 1.523 1.24 3.598 1.93 5.543 1.8 1.934.14 3.879-.28 5.673-.97 1.113-.55 2.215-1.11 3.187-1.8l3.88 5.389-.021.03Zm-7.888-14.227c0-.69-.14-1.24-.411-1.93-.271-.689-.692-1.239-1.112-1.799a6.991 6.991 0 0 0-1.935-1.38c-.822-.41-1.804-.55-2.626-.55-.972 0-1.935.14-2.767.55-.691.28-1.383.69-1.934 1.38-.551.55-.972 1.11-1.243 1.8-.281.55-.411 1.24-.411 1.93h12.459-.02ZM214.371 29h9.001v21.275l9.001-9.118h10.244l-10.525 10.638L244 70.03h-10.384l-7.478-12.157-2.626 2.63v9.527h-9.001l-.14-41.02V29Z" fill="#70706F"></path></svg>';
    const title = "Brand page title";
    const path = "/brand";
    const sameAs =
      " https://example.com, https://example2.com , https://example3.com, https://example4.com ";

    const expectedSchema = {
      "@type": "organization",
      description,
      inLanguage: countryCode,
      url: `${siteUrl}/${countryCode}/brand/`,
      sameAs: [
        "https://example.com",
        "https://example2.com",
        "https://example3.com",
        "https://example4.com"
      ],
      name: title,
      logo: expectedBrandLogo
    };

    const schema = createSchemaOrgForHomeAndBrandPage(
      siteUrl,
      "brandPage",
      countryCode,
      path,
      description,
      brandLogo,
      title,
      sameAs
    );

    expect(schema).toEqual(expectedSchema);
  });
});

describe("createSchemaOrgForHomePage", () => {
  it("should return different props schema for home page", () => {
    const countryCode = "US";

    const expectedSchema = {
      logo: renderToString(<BmiIcon />),
      name: `BMI Group ${countryCode}`
    };

    const schema = createSchemaOrgForHomePage(countryCode);

    expect(schema).toEqual(expectedSchema);
  });

  it("should return different props schema for brand page", () => {
    const brandLogo = "Zanda";

    const expectedSchema = {
      logo: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 222 100" xml:space="preserve"><path d="m0 70.994 25.414-35.69H2.67v-6.28h36.38l-23.533 35.01h24.073v6.95H0v.01ZM41.322 70.994l17.52-41.97h8.965l18.19 41.97H76.37l-4.012-10.56H54.44l-4.012 10.56h-9.105Zm16.32-16.44h12.306l-6.554-16.98-5.753 16.98ZM89.608 70.994v-41.98h8.155l23.403 28.34v-28.34h8.694v41.97h-7.224l-24.473-28.74v28.74h-8.555v.01ZM137.084 70.994v-41.98h16.579c4.142-.13 8.295.67 12.167 2.27 3.482 1.34 6.283 3.74 8.294 6.95a22.073 22.073 0 0 1 3.072 12.03c.13 4.01-.941 8.02-3.072 11.5-2.001 3.07-4.953 5.48-8.424 6.95-3.883 1.6-8.025 2.41-12.167 2.27h-16.449v.01Zm8.295-7.08h7.354c5.082 0 8.824-1.2 11.506-3.61 2.681-2.41 4.012-5.88 4.012-10.43.27-3.88-1.071-7.75-3.742-10.83-2.411-2.67-6.424-4.01-11.907-4.01h-7.353l.13 28.87v.01ZM177.606 70.994l17.65-41.97h9.094L222 70.994h-9.765l-4.012-10.56h-17.25l-4.012 10.56h-9.365.01Zm15.779-17.11h12.306l-6.153-16.31-6.153 16.31Z" fill="#E2001A"></path></svg>'
    };

    const schema = createSchemaOrgForBrandPage(brandLogo);

    expect(schema).toEqual(expectedSchema);
  });

  it("should not return logo url when brand not recognised on brand page", () => {
    const brandLogo = "does-not-exist";

    const expectedSchema = {};

    const schema = createSchemaOrgForBrandPage(brandLogo);

    expect(schema).toEqual(expectedSchema);
  });
});
