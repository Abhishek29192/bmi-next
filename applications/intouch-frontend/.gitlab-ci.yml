build_intouch_frontend:
  stage: build
  rules:
    - if: "$CI_COMMIT_TAG || $CI_MERGE_REQUEST_ID"
      changes:
        - applications/intouch-frontend/**
        - components/**
  needs: [install]
  script:
    - yarn workspace @bmi/intouch-frontend build
  interruptible: true

test_intouch_frontend:
  stage: test
  rules:
    - if: "$CI_COMMIT_TAG || $CI_MERGE_REQUEST_ID"
      changes:
        - applications/intouch-frontend/**
        - components/**
        - jest/**
  needs: [install]
  before_script:
    - yarn config set cache-folder ~/.yarn
  script:
    - yarn workspace @bmi/intouch-frontend coverage:jest
  interruptible: true

deploy_intouch_frontend_dev:
  stage: deploy
  rules:
    - if: "$CI_COMMIT_BRANCH == 'intouch/dev-environment'"
  script:
    - echo "should deploy InTouch Frontend to dev environment"
